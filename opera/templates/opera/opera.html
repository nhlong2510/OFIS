{% extends 'opera/Base.html' %}
{% load static %}
{% block title_tab %}
OperaFolio | Tax Info
{% endblock %}
{% load humanize %}
{% block content %}
<div class="main-container">
	<div class="pd-ltr-20 xs-pd-20-20">
		<div class="min-height-200px">
			<div class="page-header">
				<div class="row">
					<div class="col-12 col-lg-12">
						<div class="title">
							<h4>Demo Hotel</h4>
						</div>
						<nav aria-label="breadcrumb" role="navigation">
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="{% url 'opera:opera' %}">Home</a></li>
							</ol>
						</nav>
						
					</div>
				</div>
			</div>
			<div class="pd-20 card-box mb-30">
				<div class="row g-4 mb-4">
					<div class="col-6 col-lg-6 col-sm-12">
						<div class="app-card app-card-chart h-100 shadow-sm">
							<div class="app-card-header p-3">
								<div class="row justify-content-between align-items-center">
									<div class="col-auto">
										<h4 class="app-card-title">OFIS Invoices Status by Week and Month</h4>
									</div><!--//col-->
								</div><!--//row-->
							</div><!--//app-card-header-->
							<div class="app-card-body p-3 p-lg-4">
								<div class="mb-3 d-flex">   
								</div>
								<div class="chart-container">
									<canvas id="barchart"></canvas>
								</div>
							</div><!--//app-card-body-->
						</div><!--//app-card-->
					</div><!--//col-->
					<div class="col-6 col-lg-6 col-sm-12">
						<div class="app-card app-card-chart h-100 shadow-sm">
							<div class="app-card-header p-3">
								<div class="row justify-content-between align-items-center">
									<div class="col-auto">
										<h4 class="app-card-title">OFIS Invoices Status by Today</h4>
									</div><!--//col-->
								</div><!--//row-->
							</div><!--//app-card-header-->
							<div class="app-card-body p-3 p-lg-4">
								<div class="chart-container">
									<canvas id="horizonbar"></canvas>
								</div>
							</div><!--//app-card-body-->
						</div><!--//app-card-->
					</div>
				</div><!--//row-->
			</div>
			<!-- Striped table start -->
			<!-- <div class="pd-20 card-box mb-30">
				<div class="clearfix mb-20">
					<div class="pull-left">
						<h4 class="text-blue h4">Folio Info</h4>
					</div>
				</div>
				<table class="table table-hover data-table-export" style="width: 100%;">
					<thead>
						<tr>
							<th class="table-plus datatable-nosort" style="font-size: small;">ID</th>
							<th style="font-size: small;">Folio No.</th>
							<th style="font-size: small;">Conf. No.</th>
							<th style="font-size: small;">Room No.</th>
							<th style="font-size: small;">User</th>
							<th style="word-wrap: break-word; font-size: small;">Net Amount</th>
							<th style="word-wrap: break-word; font-size: small;">Gross Amount</th>
							<th style="word-wrap: break-word; font-size: small;">VAT</th>
							<th style="word-wrap: break-word; font-size: small;">SVC</th>
							<th style="word-wrap: break-word; font-size: small;">SCT</th>
							<th style="word-wrap: break-word; font-size: small;">Payment Method</th>
							<th style="word-wrap: break-word; font-size: small;">Folio Generate Date</th>
							<th style="word-wrap: break-word; font-size: small;">E-Invoice No.</th>
							<th style="word-wrap: break-word; font-size: small;">E-Invoice Issue Date</th>
							<th style="word-wrap: break-word; font-size: small;">E-Invoice Status</th>
						</tr>
					</thead>
					<tbody>
						{% for doc in documentinfo %}
						<tr>
							<td class="table-plus" style="font-size: small;">
								<a href="{% url 'opera:folio_detail' doc.id %}">{{ doc.id }}</a>
							</td>
							<td style="font-size: small;">{{ doc.FolioNo }}</td>
							<td style="font-size: small;">{{ doc.ConfirmationNo }}</td>
							<td style="font-size: small;">{{ doc.RoomNumber }}</td>
							<td style="font-size: small;">{{ doc.AppUser }}</td>
							<td style="font-size: small;">{{ doc.NetAmount|floatformat:'0'|intcomma }} </td>
							<td style="font-size: small;">{{ doc.GrossAmount|floatformat:'0'|intcomma }}</td>
							<td style="font-size: small;">{{ doc.Taxes.1.BucketCodeTotalGross|floatformat:'0'|intcomma }}</td>
							<td style="font-size: small;">{{ doc.Taxes.2.BucketCodeTotalGross|floatformat:'0'|intcomma }}</td>
							<td style="font-size: small;">{{ doc.Taxes.3.BucketCodeTotalGross|floatformat:'0'|intcomma }}</td>
							<td style="font-size: small; word-wrap: break-word;">{{ doc.PaymentMethod }}</td>
							<td style="font-size: small; word-wrap: break-word;">{{ doc.FolioCreatedDate }}</td>
							<td style="font-size: small; word-wrap: break-word;">{{ doc.EinvoiceInfo.EinvoiceNumber }}</td>
							<td style="font-size: small; word-wrap: break-word;">{{ doc.EinvoiceInfo.EinvoiceIssueDateTime }}</td>
							<td style="font-size: small; word-wrap: break-word;">{{ doc.EinvoiceInfo.EinvoiceStatus }}</td>
						</tr>
						{% endfor %}
					</tbody>
				
				<div class="collapse collapse-box" id="striped-table">
					<div class="code-box">
						<div class="clearfix">
							<a href="javascript:;" class="btn btn-primary btn-sm code-copy pull-left"  data-clipboard-target="#striped-table-code"><i class="fa fa-clipboard"></i> Copy Code</a>
							<a href="#striped-table" class="btn btn-primary btn-sm pull-right" rel="content-y"  data-toggle="collapse" role="button"><i class="fa fa-eye-slash"></i> Hide Code</a>
						</div>
						<pre><code class="xml copy-pre" id="striped-table-code">
							<table class="table table-striped">
							</table>
						</code></pre>
					</div>
				</div>
			</div> -->
			<!-- Striped table End -->
		</div>
	</div>
</div>
{% endblock %}

{% block scripts %}
 <!-- Charts JS -->
 <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/1.0.0/chartjs-plugin-datalabels.min.js" integrity="sha512-XulchVN83YTvsOaBGjLeApZuasKd8F4ZZ28/aMHevKjzrrjG0lor+T4VU248fWYMNki3Eimk+uwdlQS+uZmu8g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
 <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

 <script>
	const ctx1 = document.getElementById('barchart').getContext('2d');
	const barChart = new Chart(ctx1, {
		type: 'bar',
		data: {
			labels: ["today", "week", "month"],
			datasets: [{
				label: 'Number of Folios',
				data: {{ folio_list|safe }},
				backgroundColor: [
					'rgba(255, 99, 132, 0.2)',
					'rgba(54, 162, 235, 0.2)',
					'rgba(255, 206, 86, 0.2)',
					'rgba(75, 192, 192, 0.2)',
					'rgba(153, 102, 255, 0.2)',
					'rgba(255, 159, 64, 0.2)'
				],
				borderColor: [
					'rgba(255, 99, 132, 1)',
					'rgba(54, 162, 235, 1)',
					'rgba(255, 206, 86, 1)',
					'rgba(75, 192, 192, 1)',
					'rgba(153, 102, 255, 1)',
					'rgba(255, 159, 64, 1)'
				],
				borderWidth: 1,
				datalabels: {
					anchor: 'end'
				}
			}]
		},
		options: {
			scales: {
				yAxes: [{
					ticks: {
						beginAtZero: true,
						min: 0
					}
				}]
			}
		},
		plugins: [ChartDataLabels],
	});


	const ctx2 = document.getElementById('horizonbar').getContext('2d');
	const HorizonChart = new Chart(ctx2, {
		type: 'horizontalBar',
		data: {
			labels: {{ folio_status|safe }},
			datasets: [{
				label: 'Number of Folios',
				data: {{ folio_count|safe }},
				backgroundColor: [
					'rgba(255, 99, 132, 0.2)',
					'rgba(54, 162, 235, 0.2)',
				],
				borderColor: [
					'rgba(255, 99, 132, 1)',
					'rgba(54, 162, 235, 1)',
				],
				borderWidth: 1
			}]
		},
		options: {
			scales: {
				xAxes: [{
					ticks: {
						beginAtZero: true
					}
				}]
			}
		}
	});
</script>
{% endblock %}
